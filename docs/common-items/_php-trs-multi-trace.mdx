## 멀티 서버 트랜잭션 

서비스(업무) 별로 분리되어 있는 애플리케이션 서비스들 간의 호출을 추적할 수 있습니다. 와탭에 등록되어 있는 프로젝트라면 프로젝트에 등록된 애플리케이션 서비스들 간의 호출에 대한 추적을 말합니다.

1. 멀티 서버 트랜잭션 추적을 위해서는 에이전트 설정 파일에 다음 옵션을 설정하세요. `whatap.mtrace_enabled`는 값이 `true`일 때 기본값 10% 비율로 멀티 서버 트랜잭션을 추적합니다.  

    ```ini title='whatap.conf'
    whatap.mtrace_enabled=true 
    ```

1. 홈 화면 > 프로젝트 선택 > ***분석*** > ***히트맵*** 화면에서 멀티 서버 트랜잭션 추적이 적용된 경우 히트맵 트랜잭션을 드래그하세요. <!-- ***M*** --> ![아이콘](/img/ic-s-mult-transation.svg) 아이콘이 나타납니다.
    <!-- m 아이콘 확대 스크린샷 필요 -->
    ![mtrace_M](https://img.whatap.io/media/user_guide_application/dashboard/mtrace_M.png)

    멀티 서버 트랜잭션이 추적되는 경우라면 트레이스 정보 상단에 **MTID** 값이 나타납니다.

    ![mtrace_apm](/img/mtr-java-mtid.png)

    * 트랜잭션에서 외부 호출을 하는 경우에도 동일한 **MTID**가 생성됩니다.
    * 업무별로 프로젝트가 분리되어 있더라도 처음 발급한 **MTID**를 통해 애플리케이션 간의 모든 트랜잭션을 확인할 수 있습니다.

1. **MTID**를 클릭하면 동일한 **MTID**를 갖는 트랜잭션 서비스들의 개별 수행 시간을 확인할 수 있습니다.

    ![mtrace-mtid](https://img.whatap.io/media/images/Screenshot_2020-12-17_W_JAVA_DEMO_5490_-_Application_Monitoring11.png)

1. ***테이블 뷰***에서는 각 티어별 트랜잭션 트레이스 정보를 확인할 수 있습니다.

    ![mtrace-apm-tableview](https://img.whatap.io/media/images/Screenshot_2020-12-17_W_JAVA_DEMO_5490_-_Application_Monitoring12.png)

1. 같은 프로젝트에 속한 애플리케이션 서비스들 간의 호출 관계는 트레이스 내에서 데이터를 바로 확인할 수 있습니다.

    * **Caller**: 서비스를 호출한 트랜잭션 (호출자)
    * **Callee**: 서비스를 호출 당한 트랜잭션 (피호출자)

    ![mtrace-apm-13](https://img.whatap.io/media/images/Screenshot_2020-12-17_W_JAVA_DEMO_5490_-_Application_Monitoring13.png)

## 참고 자료

* [멀티 트랜잭션 메뉴 추가](https://www.whatap.io/ko/blog/85/index.html)
* [멀티트랜잭션 다이어그램 개편](https://www.whatap.io/ko/blog/72/index.html)