## マルチサーバートランザクション

サービス（業務）ごとに分離されているアプリケーションサービス間の呼び出しを追跡することができます。WhaTapに登録されているプロジェクトの場合、プロジェクトに登録されているアプリケーションサービス間の呼び出しに対する追跡のことです。

1.  マルチサーバートランザクションを追跡するには、エージェント設定ファイルに次のオプションを設定してください。`whatap.mtrace_enabled`の値が`true`の場合、デフォルト値10%の割合でマルチサーバートランザクションを追跡します。  

    ```ini title='whatap.conf'
    whatap.mtrace_enabled=true 
    ```

2.  홈 화면 > 프로젝트 선택 > **_분석_** > **_히트맵_** 화면에서 멀티 서버 트랜잭션 추적이 적용된 경우 히트맵 트랜잭션을 드래그하세요. <!-- ***M*** --> ![아이콘](/img/ic-s-mult-transation.svg) 아이콘이 나타납니다.

    <!-- m 아이콘 확대 스크린샷 필요 -->

    ![mtrace_M](https://img.whatap.io/media/user_guide_application/dashboard/mtrace_M.png)

    マルチサーバートランザクションが追跡される場合は、トレース情報の上段に**MTID**値が表示されます。

    ![mtrace_apm](/img/mtr-java-mtid.png)

    -   トランザクションで外部呼び出しをする場合でも、同じ**MTID**が生成されます。
    -   業務別にプロジェクトが分離されていても、最初に発行した**MTID**を通じてアプリケーション間のすべてのトランザクションを確認することができます。

3.  **MTID**をクリックすると、同じ**MTID**を持つトランザクションサービスの個別実行時間が確認できます。

    ![mtrace-mtid](https://img.whatap.io/media/images/Screenshot_2020-12-17_W_JAVA_DEMO_5490_-_Application_Monitoring11.png)

4.  **_テーブルビュー_**では、各ティアごとのトランザクショントレース情報を確認できます。

    ![mtrace-apm-tableview](https://img.whatap.io/media/images/Screenshot_2020-12-17_W_JAVA_DEMO_5490_-_Application_Monitoring12.png)

5.  同じプロジェクトに属するアプリケーションサービス間の呼び出し関係は、トレース内でデータをすぐに確認できます。

    -   **Caller**：サービスを呼び出したトランザクション（呼び出し元）
    -   **Callee**：サービスを呼び出されたトランザクション （呼び出し先）

    ![mtrace-apm-13](https://img.whatap.io/media/images/Screenshot_2020-12-17_W_JAVA_DEMO_5490_-_Application_Monitoring13.png)

## 参考資料

-   [マルチトランザクションメニューの追加](https://www.whatap.io/ko/blog/85/index.html)
-   [マルチトランザクションダイアグラムの改善](https://www.whatap.io/ko/blog/72/index.html)
