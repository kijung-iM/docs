---
id: warning-notice
title: サーバー警告通知
description: サーバーイベント条件設定を通じて警告通知を送信します。
tags:
  - 警告通知
  - サーバー
  - UI
---

ホーム画面 > プロジェクト選択 > **_警告通知_** > **_イベント設定_** 

<!--
> ***서버*** 탭 선택
<span class='vslow'>위험</span>, <span class='slow'>경고</span> 수준으로 나누어 알림을 보낼 수 있습니다.
-->

**_サーバー_**、**_プロセス_**、**_ログファイル_**および**_ウィンドウイベント_**などのイベントポリシーを作成・修正・削除できます。イベントタイプを選択してサーバーの再起動可否、エージェントの通信障害の持続時間、リソース使用量などに応じてイベントを設定できます。

![イベント設定 - サーバーsc](/img/server-warning.png)

-   ![指示線 1](/img/number-01.png)**_+ イベント追加_**\
      そのイベントを追加できます。

-   ![指示線 2](/img/number-02.png) **_名前_**\
      そのイベントの名前を表示します。

-   ![指示線 3](/img/number-03.png) **_条件_**\
      そのイベントの条件を表示します。

-   ![指示線 4](/img/number-04.png) **_서버_**\
      そのイベントが設定されたサーバーを表示します。    

-   ![指示線 5](/img/number-05.png) **_修整_**と **_コピー_**  
    -   ![修正アイコン](/img/ico-edit.svg)ボタンを選択して、保存されているイベント設定を**_修正_**できます。 
    -   ![コピーアイコン](/img/ico-copy.svg)ボタンを選択して、他のインフラにそのイベントを**_コピー_**できます。    

:::note

-   **_メトリクス_**イベントの追加は[次の文書](metric-warning-notice)を参考にしてください。

-   **_異常値探知_**イベントの追加は[次の文書](set-event-detect-anomal)を参考にしてください。

-   **_ログ_**イベントの追加は[次の文書](set-event-log)を参考にしてください。

:::

## サーバーイベントの追加

ホーム画面 > プロジェクト選択 > **_警告通知_** > **_イベント設定_** > **_サーバー_** タップ > **_+ イベント追加_** ボタン選択

特定のサーバーに関する全体的なイベントを設定できます。 

![イベント追加 - サーバーsc](/img/server-server-event.png)

1.  **_イベント追加_**ウインドウが表示されると![number 1](/img/number-01.png)イベント**_タイトル_**を入力してください。

2.  ![number 2](/img/number-02.png)**_サーバー一覧_**を確認するか、検索ウィンドウでモニタリングしたいサーバーを選択してください。 

3.  ![number 3](/img/number-03.png)**_イベント発行条件_**タブでご希望の**_メトリクス_**の**_条件_**、**_レーベル_**、**_持続時間_**、**_活性化_**可否を設定してください。

    -   **_レベル_**：<span class='slow'>警告</span>または<span class='vslow'>危険</span>レベルを選択できます。

    -   **_持続時間_**：設定した**_持続時間_**以降のサーバの状態が<span class='slow'>警告</span>、<span class='vslow'>危険</span>レベルに変更されます。

    **_メトリクス_**案内は以下を参考にしてください。 

    -   **_再起動_**\
          サーバーの再起動時に発生するイベントです。
    -   **_未受信_**\
          エージェントから**_持続時間_**の間、正常なデータを受信できなかった場合に発生する通信障害イベントです。
    -   **_ポット_**\
          ポート接続不可イベントです。プロジェクト内に登録されたエージェントは、**10120ポート**を通じてお互いの状態を確認します。 **_持続時間_**間通信が行われない場合に発生するイベントです。  
    -   **_CPU、Memory、スワップ_**\
          CPU、Memory、SWAPメモリなどの使用量に関するイベントを設定します。 
    -   **_Steal_**\
          CPU Steal Timeに対するイベントを設定します。Linux系のOSに限って設定できます。 
    -   **_Disk_**\
          ディスク使用量とI/O使用量、Inode使用量に基づいてイベントを設定します。 
    -   **_Network_**\
          ネットワーク使用量に関するイベントを設定します。トラフィック量と毎秒パケットを基準に設定できます。 

4.  イベント設定を終えたら![number 4](/img/number-04.png)**_保存_**ボタンを選択してください。

:::caution
1台のサーバーに1つのイベントを割り当てることができます。
:::

<details>
<summary>サーバーイベントの基本設定</summary>

WhaTapサーバーモニタリング サービスは、エージェントのインストールと同時に、次のような基本イベント設定を提供します。 

![サーバー基本通知sc](/img/server-default-notice-setting.png)

-   **_再起動_**：活性化

-   **_ネットワークIOPS_**
    -   <span class='slow'>警告</span>：45,000 pps / 持続時間：5分
    -   <span class='vslow'>危険</span>：50,000 pps / 持続時間：5分

-   **_ネットワークBPS_**
    -   <span class='slow'>警告</span>：5000,000,000 bps / 持続時間：5分
    -   <span class='vslow'>危険</span>：7000,000,000 bps / 持続時間：5分

-   **_ディスクI/O_**
    -   <span class='slow'>警告</span>：90% / 持続時間：5分
    -   <span class='vslow'>危険</span>：95% / 持続時間：5分

-   **_ディスク使用量_**
    -   <span class='slow'>警告</span>：90% / 持続時間：5分
    -   <span class='vslow'>危険</span>：95% / 持続時間：5分

-   **_inode_**
    -   <span class='slow'>警告</span>：90% / 持続時間：5分
    -   <span class='vslow'>危険</span>：95% / 持続時間：5分

-   **_CPU_**
    -   <span class='slow'>警告</span>：70% / 持続時間：1分
    -   <span class='vslow'>危険</span>：90% / 持続時間：1分

-   **_メモリ_**
    -   <span class='slow'>警告</span>：70% / 持続時間：1分
    -   <span class='vslow'>危険</span>：90% / 持続時間：1分

-   **_steal_**
    -   <span class='slow'>警告</span>：5% / 持続時間：1分
    -   <span class='vslow'>危険</span>：10% / 持続時間：1分

-   **_スワップ_**
    -   <span class='slow'>警告</span>：50% / 持続時間：1分
    -   <span class='vslow'>危険</span>：90% / 持続時間：1分

</details>

## プロセスイベントの追加{#process-event}

ホーム画面 > プロジェクト選択 > **_警告通知_** > **_イベント設定_** > **_プロセス_** タブ > **_+ イベント追加_** ボタン選択

特定プロセスに対するイベントポリシーを設定できます。

![イベント追加 - プロセスsc](/img/server-process-event.png)

1.  **_イベント追加_**ウインドウが表示されると![number 1](/img/number-01.png)イベント**_タイトル_**を入力してください。

2.  ![number 2](/img/number-02.png)**_イベント発行条件_**タブで**_サーバー一覧_**の**_選択されたエージェントがありません_**ボタンをクリックして**_サーバー一覧_**ウィンドウでサーバーを選択してください。 

    :::note

    **_プロジェクト基本ポリシー_**オプショントグル![アイコン](/img/ic-toggle-on.svg)の活性化時、プロジェクトが管理するサーバーに基本の通知ポリシーを適用します。

    :::

3.  **_プロセス_**選択ウィンドウでプロセスまたはプロセスグループを選択してください。 

    :::note

    プロセスグループの追加方法の詳細については [次の文書](server-detail-process-group.mdx)を参考にしてください。

    :::

4.  **_プロセス所有者_**を選択してください。 

    -   **_プロセス所有者_**を指定しない場合、所有者に関係なく同じ名前のすべてのプロセスにその設定が適用されます。
    -   イベント条件は、 **_プロセス所有者 _**を省略した場合でも、所有者-プロセス単位で動作します。

5.  ご希望の**_メトリクス_**の**_レベル_**、**_持続時間_**、**_活性化_**有無を設定してください。

    -   **_レベル_**：<span class='slow'>警告</span>または<span class='vslow'>危険</span>レベルを選択できます。

    -   **_持続時間_**：設定したしきい値の**_持続時間_**以降のサーバの状態が<span class='slow'>警告</span>、<span class='vslow'>危険</span>レベルに変更されます。

    **_メトリクス_**案内は以下を参考にしてください。 

    -   **_プロセス数_**\
          同じ名前のプロセスの数に対するイベントを設定できます。**_危険_**と**_警告_**条件の個数を指定してください。
    -   **_プロセスCPU_**\
          CPU使用量に応じてイベントを設定できます。
    -   **_プロセスMemory_**\
          メモリ使用量に応じてイベントを設定できます。

6.  イベント設定を終えたら![number 3](/img/number-03.png)**_保存_**ボタンを選択してください。

:::note

-   プロセス通知 **_条件_**を誤って設定した場合は、その通知を非活性化するか、通知 **_条件_**を再設定してください。
-   **_プロセス_** および **_プロセス所有者_**を誤って指定した場合は、その通知を非活性化して進行中の通知を解消した後に、通知 **_条件_**を再設定してください。

:::

## ログファイルおよびウィンドウイベントの追加

ホーム画面 > プロジェクト選択 > **_警告通知_** > **_イベント設定_** > **_ログファイル/ウィンドウイベント_** タブ > **_+ イベント追加_** ボタン選択

特定のログファイルとウィンドウイベント設定を管理できます。

### ログファイル{#log-file-event}

**_ログファイル_**イベントを追加するには、次を参考にして**_イベント発生条件_**を指定してください。 

![イベント追加 - ログファイルsc](/img/server-log-file.png)

1.  **_イベント追加_**ウインドウが表示されると![number 1](/img/number-01.png)イベント**_タイトル_**を入力してください。

2.  ![number 2](/img/number-02.png)**_サーバー一覧_**を確認するか、検索ウィンドウでモニタリングしたいサーバーを選択してください。 

    :::note

    **_プロジェクト基本ポリシー_**オプショントグル![アイコン](/img/ic-toggle-on.svg)の活性化時、プロジェクトが管理するサーバーに基本の通知ポリシーを適用します。

    :::

3.  ![number 3](/img/number-03.png)**_イベント発行条件_**タブで**_ログの種類_**を **_ログファイル_**として選択してください。

4.  例を参考にして、**_ファイルパス_**を正規表現どおり入力してください。 

    > 例）_/var/log/mylogfile_%Y-%m-%d_%H:%M:%S.log_

5.  イベントを発生させる**_検索キーワード_**を入力してください。複数指定ができます。

6.  通知から除外する**_検出除外文字列_**を入力してください。複数指定ができます。

7.  数秒間、何回指定した**_キーワード_**検出時に通知を受けるか**_繰り返し回数_**と**_期間_**を入力してください。 

8.  イベントの**_危険度_**を選択してください。<span class='vslow'>危険</span>あるいは<span class='slow'>警告</span>レベルを選択できます。

9.  ![number 4](/img/number-04.png) **_保存_**ボタンを選択してください。

### ウィンドウイベント{#windows-event}

**_ウィンドウイベント_**を追加するには、以下を参考にして**_イベント発行条件_**を指定してください。Windows環境でのみ使用できます。

![イベント追加 - イベントログsc](/img/server-window-event.png)

1.  **_イベント追加_**ウインドウが表示されると![number 1](/img/number-01.png)イベント**_タイトル_**を入力してください。

2.  ![number 2](/img/number-02.png)**_サーバー一覧_**を確認するか、検索ウィンドウでモニタリングしたいサーバーを選択してください。 

    :::note

    **_プロジェクト基本ポリシー_**オプショントグル![アイコン](/img/ic-toggle-on.svg)の活性化時、プロジェクトが管理するサーバーに基本の通知ポリシーを適用します。

    :::

3.  ![number 3](/img/number-03.png)**_イベント発行条件_**タブで**_ログの種類_**を**_ウィンドウイベント_**として選択してください。

4.  次の例を参考にして**_ログ名_**を選択してください。<br/>
    ![ログ名](https://img.whatap.io/media/user_guide_server/noti/1530.png)

5.  次の例を参考にして**_レベル_**、**_原本_**（イベントソース）、**_イベントID_**、**_検索キーワード_**を指定してください。**_検索キーワード_**は複数指定ができます。<br/>
    ![レベルイベントソースなど](https://img.whatap.io/media/user_guide_server/noti/1540.png)

6.  通知から除外する**_検出除外文字列_**を入力してください。複数指定ができます。

7.  イベントの**_危険度_**を選択してください。<span class='vslow'>危険</span>あるいは<span class='slow'>警告</span>レベルを選択できます。

8.  ![number 4](/img/number-04.png) **_保存_**ボタンを選択してください。

#### ログファイル処理量

ログファイル処理量は、ログ行数をベースに次のように設定されています。 ログの過多発生時にWhaTapサーバーモニタリングエージェントのCPU過剰使用の防止のためです。超過量は処理しません。

-   バージョン1.3.6以前：約2秒当たり60行を処理します。 
-   バージョン1.3.7以降：約2秒当たり1000行を処理します。 

次のオプションで、2秒当たりの超過量を調整できます。

-   **Linux**  
    > _/usr/whatap/infra/conf/whatap.conf_ ファイルに `log.skip.threshold=2秒当たり秒処理可能な行数`
-   **Windows**  
    > _C:\\Program Files\\WhatapInfra\\whatap.conf_ ファイルに `log.skip.threshold=2秒当たり秒処理可能な行数`

## イベント修正

1.  イベントリスト右側の![修正アイコン](/img/ico-edit.svg)**_修正_**アイコンを選択してください。 

2.  **_イベント発行条件_**タブでご希望の**_メトリクス_**の**_条件_**、**_レーベル_**、**_持続時間_**、**_活性化_**可否を修正してください。

3.  イベントの修正が終わったら**_保存_**ボタンを選択してください。

:::note

-   イベント修正時、特定メトリクスに対する変更事項がある場合、当該メトリクスにかかっていた進行中のお知らせは<span class='vslow'>Disabled</span>されます。
-   修正後、条件に合ったデータが流入すると、新しい通知が発生します。
-   プロセス通知の**_タイトル_**、**_プロセス_**、**_プロセス所有者_**いずれかの値を修正する場合、その条件にかかったすべての通知は<span class='vslow'>Disabled</span>されます。

:::

## イベント削除

1.  イベントリスト右側の![修正アイコン](/img/ico-edit.svg)**_修正_**アイコンを選択してください。 

2.  修正画面の上段右側の![削除アイコン](/img/ic-delete-critical.svg)**_削除_**アイコンを選択してください。

<!-- 로그 파일 처리량 삭제 예정 -->

<!-- 디폴트 알람 설정값 안내 추가 예정 -->

<!--

파일 경로와 키워드를 입력하세요. 

파일 로그 처리량 아래 다음 문장 의미 모호함
2초당 초과량의 조절은 다음 옵션으로 조절할 수 있습니다.

* ***파일 경로***  
    감시할 파일의 경로입니다.
* ***키워드***  
    해당 파일의 로그에서 해당 키워드가 발생하면 이벤트를 발생시킵니다.
* ***위험도***  
    이벤트가 발생하였을 때 위험도를 지정합니다.

-->

<!-- 

* **로그명**<br/>
    ![로그명](https://img.whatap.io/media/user_guide_server/noti/1530.png)
* **수준**, **이벤트 소스**, **이벤트 ID**, **키워드**<br/>
    ![수준 이벤트 소스 등](https://img.whatap.io/media/user_guide_server/noti/1540.png)
* **위험도**<br/>
    이벤트가 발생했을 때 해당 이벤트의 위험도를 지정할 수 있습니다.


:::note

특정 로그가 발생할 때 서버 상에서 자동 실행되는 스크립트를 지정할 수 있습니다.  
![이벤트 추가 - 로그 파일 - 자동 스크립트](https://img.whatap.io/media/user_guide_server/alert/alert_autoscript.png)

:::

대상 파일이 모든 서버에 존재할 경우 ***프로젝트 기본 정책*** 옵션 토글을 ![아이콘](/img/ic-toggle-on.svg) 활성화하세요. 프로젝트가 관리하는 서버에 기본 알림 정책을 자동으로 적용합니다.

-->

<!-- 

해당 알림을 비활성화 하거나 알림 조건을 재설정 후 알림 해소 조건에 맞는 데이터가 들어오면 잘못 발생한 진행 중 알림을 해소시킬 수 있습니다. 

프로세스 이벤트

![이벤트 추가 - 프로세스](https://img.whatap.io/media/images/process_event_setting_editor.png)

    * ***Enable as Project-Wide***  
        해당 프로젝트에 있는 모든 서버들에 해당 이벤트를 적용합니다.
    * ***Count***  
        해당 프로세스의 개수 증감에 대하여 이벤트를 설정할 수 있습니다. 좌측의 경우 최저치, 우측의 경우 최대치 알림입니다. 프로세스가 슬라이더 좌측보다 적거나 많다면 이벤트가 발생합니다.
    * ***CPU***  
        CPU 사용량에 따라 이벤트를 설정할 수 있습니다.
    * ***Memory***  
        메모리 사용량에 따라 이벤트를 설정할 수 있습니다.
    * ***이벤트 적용***  
        해당 프로세스에 대한 이벤트를 단일 서버가 아닌 다중 서버에 대한 정책으로 설정할 수 있습니다.
    * ***임곗값 지속 시간***     
        해당 설정된 임곗값의 지속시간 이후 서버 상태가 <span class='slow'>Warning</span>, <span class='vslow'>Fatal</span>로 변경됩니다.

서버 이벤트

![이벤트 추가 - 서버](https://img.whatap.io/media/images/server_event_setting_editor.png)

    * ***지속 시간***  
        설정한 ***지속 시간*** 이후 서버의 상태가 <span class='slow'>경고</span>, <span class='vslow'>위험</span> 수준으로 변경됩니다.


로그 싱크 제외

로그 싱크 이벤트 

로그명과 수준을 선택하고, 알림 소스, 알림 ID, 키워드를 입력하세요.

![로그 싱크 이벤트](https://img.whatap.io/media/images/logsink_event_setting_editor.png)

입력창에 다음 예시에서 해당하는 값을 선택해 추가하세요.


-->

<!-- 

로그 파일 및 윈도우 이벤트 아래 기존 안내

![이벤트 추가 - 로그 파일](https://img.whatap.io/media/images/logfile_event_setting_editor.png)

1. 해당 정책의 이름을 지정하세요.
1. 새로운 규칙을 생성하세요.
1. 지정된 규칙을 삭제하세요.
1. 삭제하거나 적용될 규칙을 선택하세요.
1. 적용될 서버를 선택하세요.
1. 특정 로그가 발생할 때 서버상에서 자동 실행되는 스크립트를 지정할 수 있습니다.  
    ![이벤트 추가 - 로그 파일 - 자동 스크립트](https://img.whatap.io/media/user_guide_server/alert/alert_autoscript.png)


-->

<!-- 

## 프로세스 그룹 이벤트{#process-group-event}

:::note
프로세스 그룹 추가 방법에 대한 자세한 내용은 [다음 문서](server-detail-process-group.mdx)를 참조하세요.
:::

프로세스 그룹의 자원 사용량 합계치가 특정 기준을 넘으면 이벤트를 받도록 지정할 수 있습니다. 프로세스 그룹을 추가하고 다음 절차를 따라 진행하세요.

### 프로세스 그룹 이벤트 추가{#process-group-event-add}

1. ***경고 알림*** > ***이벤트 설정***에서 ***+ 이벤트 추가***를 선택하세요.
1. 제목을 입력하세요.
1. 이벤트 타입을 ***프로세스***로 선택하세요.
1. ***선택된 에이전트가 없습니다*** 버튼을 선택하면 서버 목록을 조회할 수 있습니다. 
1. 해당 이벤트를 이용할 서버를 선택한 후 ***적용*** 버튼을 누르세요.
:::caution
선택한 서버가 다른 이벤트 정책을 따르고 있는 경우 현재 설정으로 이벤트 정책이 변경됩니다.
:::
1. 프로세스 목록에서 등록한 프로세스 그룹을 선택하세요.
1. 프로세스 소유자를 선택 후 ***저장*** 버튼을 선택하세요.  
    * 생략하면 소유자와 관계없이 같은 이름의 모든 프로세스에 설정이 적용됩니다.  
    * 이벤트 조건은 소유자를 생략한 경우라도 소유자-프로세스 단위로 동작합니다.

이 과정을 마치면 다음과 같이 프로세스 밑에 새로 생성한 프로세스 그룹 이벤트를 확인할 수 있습니다. 

![프로세스 그룹 이벤트](https://img.whatap.io/media/images/process_group_alarm_result.jpg)

:::note
프로세스 그룹 이벤트는 프로세스 그룹명이 아닌 이벤트 제목으로 뜹니다. 
:::


-->
