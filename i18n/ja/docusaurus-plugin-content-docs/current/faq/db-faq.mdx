---
id: db-faq
title: DB FAQ
description: WhaTapデータベースモニタリングサービスのFAQです。
tags:
  - データベースモニタリング
  - FAQ
---

WhaTapデータベースモニタリングサービスのユーザーからのよくある質問を確認してください。 

* * *

<div class ='faq'>

### Authentication plugin 'caching_sha2_password' cannot be loadedエラー

| Q. エージェントインストール後、DBに接続して_dbx.log_を確認すると`Authentication plugin 'caching_sha2_password' cannot be loaded`エラーが発生して接続できないようです。どうすればいいですか？ |
| ------------------------------------------------------------------------------------------------------------------------------------- |

> A. MySQL 8.0を使用する際に発生する可能性があります。MySql 8.0の基本認証プラグインは`caching_sha2_password`となります。`caching_sha2_password`を使用するには、SSLセキュリティ接続を使用するか、RSAセキュリティを適用した非パスワード接続を使用する必要があります。この問題を最も簡単に解決する方法は、パスワード生成時に次のように以前の`mysql_native_password`方式を使うことです。
>
> ```sql
> ALTER USER 'yourusername' IDENTIFIED WITH mysql_native_password BY 'youpassword';
> ```
>
> :::note
> 次の文書を参考にしてください。
>
> -   2.11.4 Changes in MySQL 8.0 - https://dev.mysql.com/doc/refman/8.0/en/upgrading-from-previous-series.html
> -   6.4.1.2 Caching SHA-2 Pluggable Authentication - https://dev.mysql.com/doc/refman/8.0/en/caching-sha2-pluggable-authentication.html
> :::

<br/>

### DBインスタンスにデータベースを追加作成した後、モニタリングされない場合

| Q. DBインスタンスにデータベースを追加で作成しましたが、WhaTapでモニタリングされません。どうすればいいですか？ |
| ------------------------------------------------------------ |

> A. エージェントは、db情報を起動時と起動後、1日に1回収集します。エージェントが実行中の状態でdbを追加生成した場合、反映されない可能性があります。この場合は、エージェントを再起動してください。それでも解決されなければ、適切な権限がないからかもしれません。次のように権限を付与してください。
>
> ```sql
> grant select on '追加したdb' to whatap;
> ```

<br/>

### インスタンス一覧M、S、C基準

| Q. インスタンス一覧で**_M_**、**_S_**、**_C_**の基準は何ですか? |
| -------------------------------------------- |

> A. それぞれ**_M_**aster、**_S_**lave、**_C_**lusterを意味します。Replicationで構築されたDBの場合に表示されます。Clusterは、MariaDBでgaleraソリューションで構成した場合に表示されます。 
>
> ```sql
> -- Clusterの場合：WSREP_ONがONではなく、WSREP_CLUSTER_NAMEがgaleraの場合
> select variable_name,variable_value 
> from information_schema.global_variables 
> where variable_name in ('wsrep_on','wsrep_cluster_name');
>
> -- Masterの場合：show slave hostsのデータがある場合
> show slave hosts ;
>
> -- Slave : show slave statusのデータがある場合
> show slave status ;
> ```

<br/>

### インスタンス一覧M非表示

| Q. インスタンス一覧でMasterなのに**_M_**が表示されません。理由は何ですか? |
| --------------------------------------------- |

> A. Replicationに対する権限がない場合、情報が表示されないことがあります。モニタリングアカウントの権限を確認してください。 
>
> ```sql
> --権限の確認
> show grants for whatap;
>
> --権限の付与
> grant REPLICATION SLAVE, REPLICATION CLIENT on *.* to whatap;
> ```

</div>
